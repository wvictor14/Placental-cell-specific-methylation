---
title: "Placental Cell DNA Methylation"
author: "Victor Yuan"
output:
    html_document:
    keep_md: no
    self_contained: yes
    theme: spacelab
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: no
editor_options:
  chunk_output_type: console
---

```{r, echo = F, message = F, warning = F}
library(dplyr)
library(plyr)
library(kableExtra)
```

# README

For NIH EPIC cells project

R scripts and folders are named in the following system:

* Directories are numbered by the order their contained scripts in the workflow. For example, scripts
in `0_data` are ran before `1_qc_preprocess`, which is before `2_analysis.`
* Scripts are numbered by their directory and workflow order as well. `0_1_load_data.Rmd` is in the 
`0_data` directory and is ran before `0_2_check_data.Rmd.`
* Output from scripts is stored in either `main/interim` or `main/processed`. Output is prefixed by the
same prefix of the script used to generate them. For example, `0_1_load_data.Rmd` produces 
`0_1_rgset.rds`, which is stored in `main/interim`.

# Directory structure

```
Placental Cell DNA Methylation
|   README.html
│   README.md                   
|   README.Rmd 
│   
└───data
│   └───external                  <- Data from third party sources (e.g. annotations)
│   └───main
|           └───raw               <- The original, immutable data (e.g. DNAme, pData)          
|           └───interim           <- Intermediate data that has been transformed
│           └───processed         <- The final, canonical data sets for analysis/sharing
|
└───R
|   └───0_data                   <- Downloading & loading data into R
|   └───1_qc_preprocess          <- Quality control and preprocessing data
|   └───2_analysis               <- Analyzing processed data
|   └───functions                 
|
└───outs                          <- Figures, tables, reports
```

# data

## data/main/raw/

```{r, echo = F}
main_raw <- data.frame(
  File = list.files('./data/main/raw/'),
  Description = c('final sample sheet created after week 2',
                  'sample sheet for week 1 samples (not used)')
)
kable(main_raw)  %>%
  kable_styling(c("striped", "bordered"))
```

## data/main/interim/

```{r, echo = F}

main_interim <- data.frame(
  File = list.files('./data/main/interim/'),
  Description = c('IDATs parsed/loaded using ewastools',
                  'IDATs parsed/loaded using minfi',
                  'Color code for plots',
                  'Control probes data parsed/loaded using ewastools',
                  'Correlation matrix on snp betas', #5
                  
                  'UMAP and TSNE coordinates computed on raw betas', 
                  'PCA association plot data',
                  'Phenodata with QC info',
                  'Probe QC information',
                  'SNP probe data', #10
                  
                  'Called genotypes on SNP data using ewastools', 
                  'Custom Chromosome lengths',
                  'Conumee determined binned probes for CNV calling',
                  'Probes output from conumee::CNV.write',
                  'Segments output from conumee::CNV.write', #15
                  
                  'pData with maternal contamination info', 
                  'Noob-normalized filtered autosomal probes',
                  'Noob-normalized mset object',
                  'bmiq normalized betas',
                  'predicted ethnicity from planet on all samples', #20
                  
                  'pData with predicted ethnicity',
                  'associations between covariates, for plotting',
                  'distance matrix',
                  'pca results',
                  'pData for term samples', #25
                  
                  'data to produce pheatmap',
                  'densities on betas for term samples',
                  'Term DMCs, all contrasts',
                  'updated color code key',
                  'First trimester DMCs with adjustment for mat contam', #30
                  
                  'Comparison of with/without adjustment',
                  'absolute maternal contamination estimated on "test" samples',
                  'pData for all samples, with absolute maternal contamination added'
                  ),
  Object = c('list',
             'rgchannelset',
             'list',
             'dataframe',
             'matrix', #5
             
             'dataframe', 
             'dataframe',
             'dataframe',
             'dataframe',
             'matrix', #10
             
             'list', 
             'dataframe?',
             'dataframe',
             'dataframe',
             'dataframe', #15
             
             'dataframe', 
             'matrix',
             'methylset',
             'matrix',
             'data.frame?',#20
             
             'dataframe',
             '',
             '',
             '',
             '', # 25
             
             '',
             '',
             '',
             '',
             '', # 30
             
             '',
             'dataframe',
             'dataframe') 
)

kable(main_interim)  %>%
  kable_styling(c("striped", "bordered"))
  
```

# Analysis

# References


